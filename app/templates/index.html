{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
    </div>
</div>

<div class="row">
    <div class="col-md-3 mb-4">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-mobile-alt"></i> Celulares
                </h5>
                <h2 class="card-text">{{ celulares_count }}</h2>
                <a href="{{ url_for('productos.celulares') }}" class="text-white">Ver celulares <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-4">
        <div class="card bg-success text-white">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-headphones"></i> Accesorios
                </h5>
                <h2 class="card-text">{{ accesorios_count }}</h2>
                <a href="{{ url_for('productos.accesorios') }}" class="text-white">Ver accesorios <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-4">
        <div class="card bg-info text-white">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-shopping-cart"></i> Ventas Hoy
                </h5>
                <h2 class="card-text">{{ ventas_hoy }}</h2>
                <a href="{{ url_for('ventas.lista_ventas') }}" class="text-white">Ver ventas <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-4">
        <div class="card bg-warning text-white">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-dollar-sign"></i> Total Ventas
                </h5>
                <h2 class="card-text">${{ "%.2f"|format(total_ventas_hoy) }}</h2>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-tools"></i> Servicios Técnicos Pendientes</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Tipo</th>
                                <th>Fecha Recepción</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for servicio in servicios_pendientes %}
                            <tr>
                                <td>{{ servicio.cliente_nombre }}</td>
                                <td>{{ servicio.tipo|title }}</td>
                                <td>{{ servicio.fecha_recepcion.strftime('%d/%m/%Y %H:%M') }}</td>
                                <td>
                                    <span class="badge bg-warning">{{ servicio.estado|title }}</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-exclamation-triangle"></i> Productos con Bajo Stock</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Tipo</th>
                                <th>Stock</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for celular in celulares_bajo_stock %}
                            <tr>
                                <td>{{ celular.marca.nombre }} {{ celular.modelo }}</td>
                                <td>Celular</td>
                                <td>{{ celular.stock }}</td>
                                <td>
                                    <a href="{{ url_for('productos.celulares') }}" class="btn btn-sm btn-warning">
                                        <i class="fas fa-plus"></i> Reponer
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                            {% for accesorio in accesorios_bajo_stock %}
                            <tr>
                                <td>{{ accesorio.nombre }}</td>
                                <td>{{ accesorio.categoria.nombre }}</td>
                                <td>{{ accesorio.stock }}</td>
                                <td>
                                    <a href="{{ url_for('productos.accesorios') }}" class="btn btn-sm btn-warning">
                                        <i class="fas fa-plus"></i> Reponer
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{% if current_user.rol == 'admin' %}
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-chart-line"></i> Acciones Rápidas</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <a href="{{ url_for('ventas.nueva_venta') }}" class="btn btn-primary btn-lg w-100 mb-3">
                            <i class="fas fa-shopping-cart"></i> Nueva Venta
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="{{ url_for('servicios.servicios_tecnicos') }}" class="btn btn-success btn-lg w-100 mb-3">
                            <i class="fas fa-tools"></i> Nuevo Servicio
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="{{ url_for('productos.celulares') }}" class="btn btn-info btn-lg w-100 mb-3">
                            <i class="fas fa-mobile-alt"></i> Agregar Celular
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="{{ url_for('productos.accesorios') }}" class="btn btn-warning btn-lg w-100 mb-3">
                            <i class="fas fa-headphones"></i> Agregar Accesorio
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %} 